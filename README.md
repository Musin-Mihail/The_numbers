# The Numbers Game

## Описание

"The Numbers Game" — это увлекательная игра-головоломка, созданная на движке Unity. Цель игры — очистить игровое поле, находя и убирая пары чисел. Пары могут быть образованы из двух одинаковых чисел или двух чисел, сумма которых равна 10. Проект тесно интегрирован с SDK Яндекс Игр, поддерживая сохранение прогресса в облаке, таблицу лидеров и внутриигровые покупки.


## Игровой процесс

Игроки взаимодействуют с сеткой, заполненной числами от 1 до 9.

- **Поиск пар:** Необходимо находить пары чисел, которые можно соединить. Пара считается валидной, если:

  1. Числа одинаковые (например, 7 и 7).

  2. Сумма чисел равна 10 (например, 3 и 7).

  3. Между ними нет других активных чисел по горизонтали, вертикали или при последовательном расположении в сетке.

- **Очистка поля:** Когда пара найдена, ячейки с этими числами деактивируются. Если целая строка на поле становится пустой, она удаляется, принося дополнительные очки.

- **Цель:** Полностью очистить поле от всех чисел. После очистки поля множитель очков увеличивается, и начинается новый уровень с теми же правилами, но с более высоким потенциальным счетом.


## Ключевые особенности

- **Сохранение и загрузка:** Прогресс игрока (состояние сетки, очки, счетчики действий) автоматически сохраняется с использованием облачных сохранений Яндекс Игр.

- **Система отмены ходов:** Игроки могут отменить последнее действие.

- **Подсказки:** Если игрок затрудняется найти пару, он может воспользоваться подсказкой, которая подсветит две подходящие ячейки.

- **Добавление чисел:** Игрок может добавить все оставшиеся на поле числа в конец сетки, чтобы создать новые комбинации.

- **Счетчики действий:** Использование отмены, подсказок и добавления чисел ограничено. Счетчики можно пополнить, посмотрев рекламу.

- **Внутриигровые покупки:** Имеется возможность совершить покупку, чтобы навсегда отключить ограничения на действия.

- **Таблица лидеров:** Игроки могут соревноваться друг с другом за наибольшее количество очков. Результаты заносятся в таблицу лидеров Яндекс Игр.

- **Динамический интерфейс:** Всплывающие очки и анимированные эффекты делают игровой процесс более живым и наглядным.


## Архитектура проекта

Проект построен на основе сервис-ориентированной архитектуры с использованием ScriptableObject-событий для слабой связности компонентов.


### Основные компоненты

- **Core:**

  - `GameBootstrap`: Точка входа. Инициализирует все основные сервисы и модели при запуске игры.

  - `GameController`: Обрабатывает основную игровую логику: начало новой игры, обработка ходов, отмена действий, использование подсказок и т.д.

  - `GameManager`: Управляет сохранением и загрузкой игрового состояния, а также обработкой событий, влияющих на глобальное состояние игры (например, очистка поля).

  - `LeaderboardManager`: Отвечает за отправку очков в таблицу лидеров.

  - `ServiceProvider`: Статический класс для регистрации и получения доступа к синглтон-сервисам.

  - `ActionHistory` и `IUndoableAction`: Реализация системы отмены действий.

- **Model:**

  - `GridModel`: Хранит состояние всей игровой сетки (расположение ячеек, их значения и статус).

  - `StatisticsModel`: Отвечает за подсчет очков и множителей.

  - `ActionCountersModel`: Управляет количеством доступных действий (отмена, подсказки, добавление чисел).

  - `CellData`: Модель данных для отдельной ячейки.

- **View:**

  - `GridView`: Отображает игровую сетку, управляет пулом объектов ячеек и их анимациями.

  - `Cell`: Визуальное представление ячейки на поле.

  - `ActionCountersView`, `StatisticsView`: UI-компоненты для отображения счетчиков и статистики.

  - `ConfirmationDialog`: Диалоговое окно для подтверждения действий.

  - `HeaderNumberDisplay`: Отображает "липкую" верхнюю строку чисел при прокрутке.

- **Gameplay:**

  - `MatchValidator`: Содержит логику для проверки, является ли выбранная пара ячеек валидной.

- **Events:**

  - `GameEvents`: ScriptableObject-контейнер, содержащий все игровые события для обеспечения связи между компонентами без прямых ссылок.

- **Интеграция с YG:**

  - `SavesYG`: Частичный класс, расширяющий стандартные сохранения Yandex Games Plugin для хранения данных игры.

  - Взаимодействие с API Яндекс Игр для покупок, рекламы и таблицы лидеров происходит напрямую через вызовы `YG2`.


## Структура папок (Scripts)

    Assets/Scripts/
    ├── Core/
    │   ├── Events/         # Система событий на ScriptableObject
    │   ├── Shop/           # Логика магазина
    │   ├── GameBootstrap.cs  # Инициализатор игры
    │   ├── GameController.cs # Основной контроллер логики
    │   ├── GameManager.cs    # Управление состоянием игры
    │   ├── LeaderboardManager.cs # Управление таблицей лидеров
    │   ├── ServiceProvider.cs# Сервис-локатор
    │   └── UndoSystem.cs     # Система отмены действий
    ├── DataProviders/
    │   └── GridDataProvider.cs # Поставщик данных о сетке
    ├── Gameplay/
    │   └── MatchValidator.cs # Валидатор пар
    ├── Model/
    │   ├── GridModel.cs      # Модель сетки
    │   ├── StatisticsModel.cs# Модель статистики
    │   └── ...               # Другие модели данных
    ├── View/
    │   ├── Grid/             # Компоненты для отображения сетки
    │   └── UI/               # Компоненты пользовательского интерфейса
    └── YG/
        └── SavesYG.cs        # Схема данных для сохранения


## Зависимости

- **Unity** (версия 2021.3 или выше)

- **Yandex Games Plugin** (YG) - для интеграции с платформой Яндекс Игр.
